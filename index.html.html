<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpayWeather - Prévisions météo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            overflow: hidden;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            transition: background 1s ease;
        }

        .app-container {
            position: relative;
            z-index: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.4);
            color: white;
            backdrop-filter: blur(8px);
            transition: all 0.5s ease;
        }

        .header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .search-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #city-input {
            padding: 12px 20px;
            border: none;
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 16px;
            outline: none;
            width: 200px;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            backdrop-filter: blur(5px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        #city-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        #city-input:focus {
            background: rgba(255, 255, 255, 0.25);
            width: 250px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        #search-btn {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 50%;
            background: rgba(76, 201, 240, 0.7);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(76, 201, 240, 0.3);
        }

        #search-btn:hover {
            background: rgba(76, 201, 240, 0.9);
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 6px 20px rgba(76, 201, 240, 0.4);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            text-align: center;
            overflow-y: auto;
        }

        .current-weather {
            margin-bottom: 20px;
            width: 100%;
            animation: fadeIn 0.8s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #city-name {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            letter-spacing: 0.5px;
        }

        .weather-main {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        #weather-icon {
            font-size: 80px;
            text-shadow: 0 2px 15px rgba(0, 0, 0, 0.5);
            animation: pulse 2s infinite alternate;
        }

        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        #temp {
            font-size: 72px;
            font-weight: 300;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            background: linear-gradient(45deg, #fff, #4cc9f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        #weather-desc {
            font-size: 24px;
            margin-bottom: 15px;
            text-transform: capitalize;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            font-weight: 500;
        }

        .weather-details {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .detail {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            min-width: 100px;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .detail i {
            font-size: 24px;
            margin-bottom: 5px;
            color: #4cc9f0;
        }

        .detail span {
            display: block;
            font-size: 18px;
        }

        .forecast-container {
            width: 100%;
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.8s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .forecast-title {
            font-size: 20px;
            margin-bottom: 15px;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #4cc9f0;
        }

        .forecast-title i {
            color: #4cc9f0;
        }

        .forecast-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .day-tab {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 14px;
        }

        .day-tab.active {
            background: rgba(76, 201, 240, 0.3);
            box-shadow: 0 0 10px rgba(76, 201, 240, 0.5);
        }

        .day-tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .hourly-forecast {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            padding: 15px 0;
        }

        .hour-item {
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .hour-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }

        .hour-time {
            font-weight: 500;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .hour-icon {
            font-size: 20px;
            margin: 5px 0;
            color: #ffd700;
        }

        .hour-temp {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .hour-details {
            font-size: 12px;
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
        }

        .hour-details div {
            margin-top: 3px;
        }

        .daily-forecast {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .day-item {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            min-width: 0;
            cursor: pointer;
        }

        .day-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }

        .day-name {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 16px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%;
            text-align: center;
        }

        .day-date {
            font-size: 14px;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
        }

        .day-icon {
            font-size: 30px;
            margin: 10px 0;
            color: #ffd700;
        }

        .day-temp {
            font-weight: 600;
            font-size: 18px;
        }

        .sun-info {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            text-align: left;
            animation: fadeIn 0.5s ease;
        }

        .sun-info.active {
            display: block;
        }

        .uv-info {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            text-align: left;
            animation: fadeIn 0.5s ease;
        }

        .uv-info.active {
            display: block;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .tab-container {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
        }

        .tab.active {
            border-bottom: 3px solid #4cc9f0;
            color: #4cc9f0;
            background: rgba(76, 201, 240, 0.1);
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .music-control {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .music-control:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .music-control i {
            font-size: 20px;
            color: white;
        }

        .location-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 14px;
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .location-info:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
        }

        .location-info i {
            color: #4cc9f0;
        }

        .lang-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 25px;
            font-size: 14px;
            backdrop-filter: blur(5px);
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .lang-selector:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        #language-select {
            background: transparent;
            border: none;
            color: white;
            outline: none;
            cursor: pointer;
        }

        #language-select option {
            background: rgba(0, 0, 0, 0.8);
            color: white;
        }

        .uv-index {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
            gap: 15px;
            flex-wrap: wrap;
        }

        .uv-value {
            font-size: 36px;
            font-weight: 700;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .uv-low {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .uv-moderate {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
        }

        .uv-high {
            background: linear-gradient(135deg, #e67e22, #d35400);
        }

        .uv-very-high {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .uv-extreme {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .uv-label {
            font-size: 18px;
            font-weight: 600;
        }

        .glow {
            text-shadow: 0 0 10px rgba(76, 201, 240, 0.7);
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .news-container {
            width: 100%;
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.8s ease;
        }

        .news-title {
            font-size: 20px;
            margin-bottom: 15px;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #4cc9f0;
        }

        .news-title i {
            color: #4cc9f0;
        }

        .news-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .news-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: left;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .news-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        .news-item h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: #4cc9f0;
        }

        .news-item p {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
        }

        .news-item a {
            color: #4cc9f0;
            text-decoration: none;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .news-item a:hover {
            text-decoration: underline;
        }

        .wind-direction {
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            position: relative;
            margin-left: 5px;
        }

        .wind-direction::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-bottom: 8px solid white;
            transform-origin: 50% 0;
            transform: translate(-50%, -50%);
        }

        .pressure-trend {
            display: inline-block;
            margin-left: 5px;
        }

        .pressure-trend.up::after {
            content: '↑';
            color: #2ecc71;
        }

        .pressure-trend.down::after {
            content: '↓';
            color: #e74c3c;
        }

        .pressure-trend.steady::after {
            content: '→';
            color: #f39c12;
        }

        /* Couleurs des icônes météo */
        .fa-cloud { color: #a0a0a0; } /* Nuages normaux */
        .fa-cloud-rain { color: #b0b0b0; } /* Pluie - gris clair */
        .fa-cloud-showers-heavy { color: #b0b0b0; } /* Forte pluie - gris clair */
        .fa-bolt { color: #303030; } /* Orage - gris très foncé */
        .fa-cloud-sun { color: #a0a0a0; }
        .fa-cloud-moon { color: #a0a0a0; }

        @media (max-width: 600px) {
            #city-name {
                font-size: 26px;
            }

            #temp {
                font-size: 60px;
            }

            .hour-item {
                min-width: 50px;
                padding: 8px 5px;
            }

            .day-item {
                padding: 10px 5px;
            }

            .day-name {
                font-size: 14px;
            }

            .day-icon {
                font-size: 24px;
            }

            .day-temp {
                font-size: 16px;
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }

            .lang-selector {
                top: 10px;
                right: 10px;
            }

            .tab {
                padding: 8px 12px;
                font-size: 14px;
            }

            .weather-details {
                gap: 10px;
            }

            .detail {
                min-width: 80px;
                padding: 10px;
            }

            .detail i {
                font-size: 20px;
            }

            .detail span {
                font-size: 16px;
            }
            
            .hourly-forecast {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Musique d'ambiance -->
    <audio autoplay loop id="bg-music">
        <source src="AURA of GLORY (Super Slowed).mp3" type="audio/mpeg">
    </audio>

    <!-- Contrôle musique -->
    <div class="music-control" id="music-toggle">
        <i class="fas fa-music"></i>
    </div>

    <!-- Sélecteur de langue -->
    <div class="lang-selector">
        <select id="language-select">
            <option value="fr">Français</option>
            <option value="en">English</option>
            <option value="es">Español</option>
            <option value="de">Deutsch</option>
            <option value="it">Italiano</option>
            <option value="pt">Português</option>
            <option value="ru">Русский</option>
            <option value="zh">中文</option>
            <option value="ja">日本語</option>
            <option value="ar">العربية</option>
        </select>
    </div>

    <!-- Application météo -->
    <div class="app-container">
        <header class="header">
            <h1 id="app-title">SpayWeather</h1>
            <div class="search-container">
                <input type="text" id="city-input" placeholder="Rechercher une ville...">
                <button id="search-btn"><i class="fas fa-search"></i></button>
            </div>
        </header>

        <main class="main-content">
            <div class="current-weather">
                <h2 id="city-name">Chargement...</h2>
                <div class="weather-main">
                    <div id="weather-icon"><i class="fas fa-sun"></i></div>
                    <div><span id="temp">--</span>°</div>
                </div>
                <p id="weather-desc">--</p>

                <div class="weather-details">
                    <div class="detail">
                        <i class="fas fa-tint"></i>
                        <span id="humidity">--%</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-wind"></i>
                        <span id="wind">-- km/h</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-sun"></i>
                        <span id="uv-index">--</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-temperature-low"></i>
                        <span id="feels-like">--°C</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-eye"></i>
                        <span id="visibility">-- km</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-tachometer-alt"></i>
                        <span id="pressure">-- hPa</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-mountain"></i>
                        <span id="altitude">-- m</span>
                    </div>
                </div>
            </div>

            <!-- Prévisions -->
            <div class="forecast-container">
                <div class="tab-container">
                    <div class="tab active" id="hourly-tab"><i class="fas fa-clock"></i> Prévisions</div>
                    <div class="tab" id="sun-tab"><i class="fas fa-sun"></i> Soleil</div>
                    <div class="tab" id="uv-tab"><i class="fas fa-sun"></i> UV</div>
                </div>

                <div id="hourly-content">
                    <!-- Navigation par jour -->
                    <div class="forecast-navigation" id="day-navigation">
                        <!-- Rempli par JavaScript avec les jours -->
                    </div>

                    <!-- Prévisions horaires -->
                    <div class="hourly-forecast" id="hourly-forecast">
                        <!-- Rempli par JavaScript avec les heures spécifiques -->
                    </div>

                    <!-- Prévisions sur 5 jours -->
                    <div class="daily-forecast" id="daily-forecast">
                        <!-- Rempli par JavaScript avec les jours -->
                    </div>
                </div>

                <!-- Info soleil -->
                <div class="sun-info" id="sun-info">
                    <div class="detail-row">
                        <span><i class="fas fa-sunrise"></i> Lever du soleil</span>
                        <span id="sunrise-value">--:--</span>
                    </div>
                    <div class="detail-row">
                        <span><i class="fas fa-sunset"></i> Coucher du soleil</span>
                        <span id="sunset-value">--:--</span>
                    </div>
                    <div class="detail-row">
                        <span><i class="fas fa-clock"></i> Durée du jour</span>
                        <span id="daylight-value">--h --m</span>
                    </div>
                    <div class="detail-row">
                        <span><i class="fas fa-moon"></i> Phase lunaire</span>
                        <span id="moon-phase">--</span>
                    </div>
                </div>

                <!-- Info UV -->
                <div class="uv-info" id="uv-info">
                    <div class="uv-index">
                        <div class="uv-value uv-low" id="uv-value">--</div>
                        <div class="uv-label" id="uv-label">--</div>
                    </div>
                    <div class="detail-row">
                        <span>0-2</span>
                        <span>Faible</span>
                    </div>
                    <div class="detail-row">
                        <span>3-5</span>
                        <span>Modéré</span>
                    </div>
                    <div class="detail-row">
                        <span>6-7</span>
                        <span>Élevé</span>
                    </div>
                    <div class="detail-row">
                        <span>8-10</span>
                        <span>Très élevé</span>
                    </div>
                    <div class="detail-row">
                        <span>11+</span>
                        <span>Extrême</span>
                    </div>
                </div>
            </div>

            <!-- Section actualités -->
            <div class="news-container">
                <h2 class="news-title"><i class="fas fa-newspaper"></i> Actualités du moment</h2>
                <div class="news-list" id="news-list">
                    <!-- Rempli par JavaScript avec les actualités -->
                </div>
            </div>
        </main>

        <!-- Info de localisation -->
        <div class="location-info" id="location-info">
            <i class="fas fa-map-marker-alt"></i>
            <span id="location-text">Localisation en cours...</span>
        </div>
    </div>

    <script>
        // Fonction pour mettre à jour le fond selon l'heure
        function updateBackgroundBasedOnTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const totalMinutes = hours * 60 + minutes;
            
            // Définir les plages horaires (8h30-21h30 = jour, sinon nuit)
            const isDayTime = (totalMinutes >= 8.5 * 60 && totalMinutes < 21.5 * 60);
            
            // Changer le fond en fonction
            if (isDayTime) {
                // Fond jour - dégradé de bleu clair
                document.body.style.background = 'linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%)';
            } else {
                // Fond nuit - dégradé de bleu nuit
                document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
            }
        }

        // Appeler la fonction au chargement
        updateBackgroundBasedOnTime();

        // Vérifier toutes les minutes pour changer le fond si nécessaire
        setInterval(updateBackgroundBasedOnTime, 60000);

        // Configuration API
        const WEATHER_API_KEY = 'eb29384628c0ba8611b8df0ef02a7377';
        const NEWS_API_KEY = 'a6e2c5b6f1msh8a0c1e5d8b8b3a3p1b8e6djsn9b5c5e5e5e5e'; // Remplacez par votre clé API News

        // Éléments du DOM
        const elements = {
            cityInput: document.getElementById('city-input'),
            searchBtn: document.getElementById('search-btn'),
            cityName: document.getElementById('city-name'),
            weatherIcon: document.getElementById('weather-icon'),
            temp: document.getElementById('temp'),
            weatherDesc: document.getElementById('weather-desc'),
            humidity: document.getElementById('humidity'),
            wind: document.getElementById('wind'),
            uvIndex: document.getElementById('uv-index'),
            feelsLike: document.getElementById('feels-like'),
            visibility: document.getElementById('visibility'),
            pressure: document.getElementById('pressure'),
            altitude: document.getElementById('altitude'),
            musicToggle: document.getElementById('music-toggle'),
            bgMusic: document.getElementById('bg-music'),
            hourlyForecast: document.getElementById('hourly-forecast'),
            dailyForecast: document.getElementById('daily-forecast'),
            locationInfo: document.getElementById('location-info'),
            locationText: document.getElementById('location-text'),
            languageSelect: document.getElementById('language-select'),
            appTitle: document.getElementById('app-title'),
            hourlyTab: document.getElementById('hourly-tab'),
            sunTab: document.getElementById('sun-tab'),
            uvTab: document.getElementById('uv-tab'),
            hourlyContent: document.getElementById('hourly-content'),
            sunInfo: document.getElementById('sun-info'),
            uvInfo: document.getElementById('uv-info'),
            sunriseValue: document.getElementById('sunrise-value'),
            sunsetValue: document.getElementById('sunset-value'),
            daylightValue: document.getElementById('daylight-value'),
            moonPhase: document.getElementById('moon-phase'),
            uvValue: document.getElementById('uv-value'),
            uvLabel: document.getElementById('uv-label'),
            newsList: document.getElementById('news-list'),
            dayNavigation: document.getElementById('day-navigation')
        };

        // Icônes météo
        const weatherIcons = {
            '01d': 'fa-sun',           // ciel clair (jour)
            '01n': 'fa-moon',          // ciel clair (nuit)
            '02d': 'fa-cloud-sun',     // quelques nuages (jour)
            '02n': 'fa-cloud-moon',    // quelques nuages (nuit)
            '03d': 'fa-cloud',         // nuages dispersés
            '03n': 'fa-cloud',
            '04d': 'fa-cloud',         // nuages brisés
            '04n': 'fa-cloud',
            '09d': 'fa-cloud-rain',    // pluie légère
            '09n': 'fa-cloud-rain',
            '10d': 'fa-cloud-showers-heavy', // pluie
            '10n': 'fa-cloud-showers-heavy',
            '11d': 'fa-bolt',         // orage
            '11n': 'fa-bolt',
            '13d': 'fa-snowflake',    // neige
            '13n': 'fa-snowflake',
            '50d': 'fa-smog',         // brouillard
            '50n': 'fa-smog'
        };

        // Phases lunaires
        const moonPhases = {
            0: 'Nouvelle lune',
            1: 'Premier croissant',
            2: 'Premier quartier',
            3: 'Lune gibbeuse croissante',
            4: 'Pleine lune',
            5: 'Lune gibbeuse décroissante',
            6: 'Dernier quartier',
            7: 'Dernier croissant'
        };

        // Jours de la semaine
        const weekDays = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];

        // Directions du vent
        const windDirections = {
            'N': 0,
            'NNE': 22.5,
            'NE': 45,
            'ENE': 67.5,
            'E': 90,
            'ESE': 112.5,
            'SE': 135,
            'SSE': 157.5,
            'S': 180,
            'SSW': 202.5,
            'SW': 225,
            'WSW': 247.5,
            'W': 270,
            'WNW': 292.5,
            'NW': 315,
            'NNW': 337.5
        };

        // Traductions
        const translations = {
            fr: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Rechercher une ville...",
                loading: "Chargement...",
                hourlyTab: "Prévisions",
                sunTab: "Soleil",
                uvTab: "UV",
                sunrise: "Lever du soleil",
                sunset: "Coucher du soleil",
                daylight: "Durée du jour",
                moonPhase: "Phase lunaire",
                locationText: "Localisation en cours...",
                locationFound: "Vous êtes à {city}",
                locationError: "Localisation non disponible",
                uvLabels: {
                    low: "Faible",
                    moderate: "Modéré",
                    high: "Élevé",
                    veryHigh: "Très élevé",
                    extreme: "Extrême"
                },
                uvGuide: {
                    "0-2": "Faible",
                    "3-5": "Modéré",
                    "6-7": "Élevé",
                    "8-10": "Très élevé",
                    "11+": "Extrême"
                },
                newsTitle: "Actualités du moment",
                windDirections: {
                    'N': 'Nord',
                    'NNE': 'Nord-Nord-Est',
                    'NE': 'Nord-Est',
                    'ENE': 'Est-Nord-Est',
                    'E': 'Est',
                    'ESE': 'Est-Sud-Est',
                    'SE': 'Sud-Est',
                    'SSE': 'Sud-Sud-Est',
                    'S': 'Sud',
                    'SSW': 'Sud-Sud-Ouest',
                    'SW': 'Sud-Ouest',
                    'WSW': 'Ouest-Sud-Ouest',
                    'W': 'Ouest',
                    'WNW': 'Ouest-Nord-Ouest',
                    'NW': 'Nord-Ouest',
                    'NNW': 'Nord-Nord-Ouest'
                }
            },
            en: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Search for a city...",
                loading: "Loading...",
                hourlyTab: "Forecast",
                sunTab: "Sun",
                uvTab: "UV",
                sunrise: "Sunrise",
                sunset: "Sunset",
                daylight: "Daylight",
                moonPhase: "Moon phase",
                locationText: "Locating...",
                locationFound: "You are in {city}",
                locationError: "Location not available",
                uvLabels: {
                    low: "Low",
                    moderate: "Moderate",
                    high: "High",
                    veryHigh: "Very High",
                    extreme: "Extreme"
                },
                uvGuide: {
                    "0-2": "Low",
                    "3-5": "Moderate",
                    "6-7": "High",
                    "8-10": "Very High",
                    "11+": "Extreme"
                },
                newsTitle: "Latest News",
                windDirections: {
                    'N': 'North',
                    'NNE': 'North-Northeast',
                    'NE': 'Northeast',
                    'ENE': 'East-Northeast',
                    'E': 'East',
                    'ESE': 'East-Southeast',
                    'SE': 'Southeast',
                    'SSE': 'South-Southeast',
                    'S': 'South',
                    'SSW': 'South-Southwest',
                    'SW': 'Southwest',
                    'WSW': 'West-Southwest',
                    'W': 'West',
                    'WNW': 'West-Northwest',
                    'NW': 'Northwest',
                    'NNW': 'North-Northwest'
                }
            },
            es: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Buscar una ciudad...",
                loading: "Cargando...",
                hourlyTab: "Pronóstico",
                sunTab: "Sol",
                uvTab: "UV",
                sunrise: "Amanecer",
                sunset: "Atardecer",
                daylight: "Duración del día",
                moonPhase: "Fase lunar",
                locationText: "Localizando...",
                locationFound: "Estás en {city}",
                locationError: "Ubicación no disponible",
                uvLabels: {
                    low: "Bajo",
                    moderate: "Moderado",
                    high: "Alto",
                    veryHigh: "Muy Alto",
                    extreme: "Extremo"
                },
                uvGuide: {
                    "0-2": "Bajo",
                    "3-5": "Moderado",
                    "6-7": "Alto",
                    "8-10": "Muy Alto",
                    "11+": "Extremo"
                },
                newsTitle: "Últimas noticias",
                windDirections: {
                    'N': 'Norte',
                    'NNE': 'Norte-Noreste',
                    'NE': 'Noreste',
                    'ENE': 'Este-Noreste',
                    'E': 'Este',
                    'ESE': 'Este-Sureste',
                    'SE': 'Sureste',
                    'SSE': 'Sur-Sureste',
                    'S': 'Sur',
                    'SSW': 'Sur-Suroeste',
                    'SW': 'Suroeste',
                    'WSW': 'Oeste-Suroeste',
                    'W': 'Oeste',
                    'WNW': 'Oeste-Noroeste',
                    'NW': 'Noroeste',
                    'NNW': 'Norte-Noroeste'
                }
            },
            de: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Suche nach einer Stadt...",
                loading: "Laden...",
                hourlyTab: "Vorhersage",
                sunTab: "Sonne",
                uvTab: "UV",
                sunrise: "Sonnenaufgang",
                sunset: "Sonnenuntergang",
                daylight: "Tageslicht",
                moonPhase: "Mondphase",
                locationText: "Ortung...",
                locationFound: "Sie sind in {city}",
                locationError: "Standort nicht verfügbar",
                uvLabels: {
                    low: "Niedrig",
                    moderate: "Mäßig",
                    high: "Hoch",
                    veryHigh: "Sehr hoch",
                    extreme: "Extrem"
                },
                uvGuide: {
                    "0-2": "Niedrig",
                    "3-5": "Mäßig",
                    "6-7": "Hoch",
                    "8-10": "Sehr hoch",
                    "11+": "Extrem"
                },
                newsTitle: "Aktuelle Nachrichten",
                windDirections: {
                    'N': 'Nord',
                    'NNE': 'Nord-Nordost',
                    'NE': 'Nordost',
                    'ENE': 'Ost-Nordost',
                    'E': 'Ost',
                    'ESE': 'Ost-Südost',
                    'SE': 'Südost',
                    'SSE': 'Süd-Südost',
                    'S': 'Süd',
                    'SSW': 'Süd-Südwest',
                    'SW': 'Südwest',
                    'WSW': 'West-Südwest',
                    'W': 'West',
                    'WNW': 'West-Nordwest',
                    'NW': 'Nordwest',
                    'NNW': 'Nord-Nordwest'
                }
            },
            it: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Cerca una città...",
                loading: "Caricamento...",
                hourlyTab: "Previsioni",
                sunTab: "Sole",
                uvTab: "UV",
                sunrise: "Alba",
                sunset: "Tramonto",
                daylight: "Luce del giorno",
                moonPhase: "Fase lunare",
                locationText: "Localizzazione...",
                locationFound: "Sei a {city}",
                locationError: "Posizione non disponibile",
                uvLabels: {
                    low: "Basso",
                    moderate: "Moderato",
                    high: "Alto",
                    veryHigh: "Molto alto",
                    extreme: "Estremo"
                },
                uvGuide: {
                    "0-2": "Basso",
                    "3-5": "Moderato",
                    "6-7": "Alto",
                    "8-10": "Molto alto",
                    "11+": "Estremo"
                },
                newsTitle: "Ultime notizie",
                windDirections: {
                    'N': 'Nord',
                    'NNE': 'Nord-Nordest',
                    'NE': 'Nordest',
                    'ENE': 'Est-Nordest',
                    'E': 'Est',
                    'ESE': 'Est-Sudest',
                    'SE': 'Sudest',
                    'SSE': 'Sud-Sudest',
                    'S': 'Sud',
                    'SSW': 'Sud-Sudovest',
                    'SW': 'Sudovest',
                    'WSW': 'Ovest-Sudovest',
                    'W': 'Ovest',
                    'WNW': 'Ovest-Nordovest',
                    'NW': 'Nordovest',
                    'NNW': 'Nord-Nordovest'
                }
            },
            pt: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Pesquisar por uma cidade...",
                loading: "Carregando...",
                hourlyTab: "Previsão",
                sunTab: "Sol",
                uvTab: "UV",
                sunrise: "Nascer do sol",
                sunset: "Pôr do sol",
                daylight: "Duração do día",
                moonPhase: "Fase lunar",
                locationText: "Localizando...",
                locationFound: "Você está em {city}",
                locationError: "Localização não disponível",
                uvLabels: {
                    low: "Baixo",
                    moderate: "Moderado",
                    high: "Alto",
                    veryHigh: "Muito alto",
                    extreme: "Extremo"
                },
                uvGuide: {
                    "0-2": "Baixo",
                    "3-5": "Moderado",
                    "6-7": "Alto",
                    "8-10": "Muito alto",
                    "11+": "Extremo"
                },
                newsTitle: "Últimas notícias",
                windDirections: {
                    'N': 'Norte',
                    'NNE': 'Norte-Nordeste',
                    'NE': 'Nordeste',
                    'ENE': 'Leste-Nordeste',
                    'E': 'Leste',
                    'ESE': 'Leste-Sudeste',
                    'SE': 'Sudeste',
                    'SSE': 'Sul-Sudeste',
                    'S': 'Sul',
                    'SSW': 'Sul-Sudoeste',
                    'SW': 'Sudoeste',
                    'WSW': 'Oeste-Sudoeste',
                    'W': 'Oeste',
                    'WNW': 'Oeste-Noroeste',
                    'NW': 'Noroeste',
                    'NNW': 'Norte-Noroeste'
                }
            },
            ru: {
                appTitle: "SpayWeather",
                searchPlaceholder: "Поиск города...",
                loading: "Загрузка...",
                hourlyTab: "Прогноз",
                sunTab: "Солнце",
                uvTab: "УФ",
                sunrise: "Восход",
                sunset: "Закат",
                daylight: "Продолжительность дня",
                moonPhase: "Фаза луны",
                locationText: "Определение местоположения...",
                locationFound: "Вы в {city}",
                locationError: "Местоположение недоступно",
                uvLabels: {
                    low: "Низкий",
                    moderate: "Умеренный",
                    high: "Высокий",
                    veryHigh: "Очень высокий",
                    extreme: "Экстремальный"
                },
                uvGuide: {
                    "0-2": "Низкий",
                    "3-5": "Умеренный",
                    "6-7": "Высокий",
                    "8-10": "Очень высокий",
                    "11+": "Экстремальный"
                },
                newsTitle: "Последние новости",
                windDirections: {
                    'N': 'Север',
                    'NNE': 'Северо-северо-восток',
                    'NE': 'Северо-восток',
                    'ENE': 'Восток-северо-восток',
                    'E': 'Восток',
                    'ESE': 'Восток-юго-восток',
                    'SE': 'Юго-восток',
                    'SSE': 'Юг-юго-восток',
                    'S': 'Юг',
                    'SSW': 'Юг-юго-запад',
                    'SW': 'Юго-запад',
                    'WSW': 'Запад-юго-запад',
                    'W': 'Запад',
                    'WNW': 'Запад-северо-запад',
                    'NW': 'Северо-запад',
                    'NNW': 'Северо-северо-запад'
                }
            },
            zh: {
                appTitle: "SpayWeather",
                searchPlaceholder: "搜索城市...",
                loading: "加载中...",
                hourlyTab: "预报",
                sunTab: "太阳",
                uvTab: "紫外线",
                sunrise: "日出",
                sunset: "日落",
                daylight: "日照时间",
                moonPhase: "月相",
                locationText: "定位中...",
                locationFound: "您在{city}",
                locationError: "位置不可用",
                uvLabels: {
                    low: "低",
                    moderate: "中等",
                    high: "高",
                    veryHigh: "很高",
                    extreme: "极高"
                },
                uvGuide: {
                    "0-2": "低",
                    "3-5": "中等",
                    "6-7": "高",
                    "8-10": "很高",
                    "11+": "极高"
                },
                newsTitle: "最新消息",
                windDirections: {
                    'N': '北',
                    'NNE': '北东北',
                    'NE': '东北',
                    'ENE': '东北东',
                    'E': '东',
                    'ESE': '东南东',
                    'SE': '东南',
                    'SSE': '南东南',
                    'S': '南',
                    'SSW': '南西南',
                    'SW': '西南',
                    'WSW': '西南西',
                    'W': '西',
                    'WNW': '西北西',
                    'NW': '西北',
                    'NNW': '北西北'
                }
            },
            ja: {
                appTitle: "SpayWeather",
                searchPlaceholder: "都市を検索...",
                loading: "読み込み中...",
                hourlyTab: "予報",
                sunTab: "太陽",
                uvTab: "UV",
                sunrise: "日の出",
                sunset: "日没",
                daylight: "日照時間",
                moonPhase: "月相",
                locationText: "位置情報取得中...",
                locationFound: "あなたは{city}にいます",
                locationError: "位置情報が利用できません",
                uvLabels: {
                    low: "弱い",
                    moderate: "中程度",
                    high: "強い",
                    veryHigh: "非常に強い",
                    extreme: "極端に強い"
                },
                uvGuide: {
                    "0-2": "弱い",
                    "3-5": "中程度",
                    "6-7": "強い",
                    "8-10": "非常に強い",
                    "11+": "極端に強い"
                },
                newsTitle: "最新ニュース",
                windDirections: {
                    'N': '北',
                    'NNE': '北北東',
                    'NE': '北東',
                    'ENE': '東北東',
                    'E': '東',
                    'ESE': '東南東',
                    'SE': '南東',
                    'SSE': '南南東',
                    'S': '南',
                    'SSW': '南南西',
                    'SW': '南西',
                    'WSW': '西南西',
                    'W': '西',
                    'WNW': '西北西',
                    'NW': '北西',
                    'NNW': '北北西'
                }
            },
            ar: {
                appTitle: "SpayWeather",
                searchPlaceholder: "ابحث عن مدينة...",
                loading: "جار التحميل...",
                hourlyTab: "التنبؤ",
                sunTab: "الشمس",
                uvTab: "الأشعة فوق البنفسجية",
                sunrise: "شروق الشمس",
                sunset: "غروب الشمس",
                daylight: "مدة النهار",
                moonPhase: "طور القمر",
                locationText: "جاري تحديد الموقع...",
                locationFound: "أنت في {city}",
                locationError: "الموقع غير متاح",
                uvLabels: {
                    low: "منخفض",
                    moderate: "متوسط",
                    high: "مرتفع",
                    veryHigh: "مرتفع جداً",
                    extreme: "شديد"
                },
                uvGuide: {
                    "0-2": "منخفض",
                    "3-5": "متوسط",
                    "6-7": "مرتفع",
                    "8-10": "مرتفع جداً",
                    "11+": "شديد"
                },
                newsTitle: "آخر الأخبار",
                windDirections: {
                    'N': 'شمال',
                    'NNE': 'شمال شمال شرق',
                    'NE': 'شمال شرق',
                    'ENE': 'شرق северо-восток',
                    'E': 'شرق',
                    'ESE': 'شرق جنوب شرق',
                    'SE': 'جنوب شرق',
                    'SSE': 'جنوب جنوب شرق',
                    'S': 'جنوب',
                    'SSW': 'جنوب جنوب غرب',
                    'SW': 'جنوب غرب',
                    'WSW': 'غرب جنوب غرب',
                    'W': 'غرب',
                    'WNW': 'غرب شمال غرب',
                    'NW': 'شمال غرب',
                    'NNW': 'شمال شمال غرب'
                }
            }
        };

        // Données de prévision
        let forecastData = [];
        let currentLanguage = 'fr';
        let userLocation = null;
        let currentWeatherData = null;
        let refreshInterval = null;
        let forecastRefreshInterval = null;
        let newsRefreshInterval = null;

        // Initialisation
        function init() {
            // Détecter la langue du navigateur
            const browserLang = navigator.language || navigator.userLanguage;
            currentLanguage = browserLang.split('-')[0];
            if (!translations[currentLanguage]) {
                currentLanguage = 'fr'; // Fallback to French
            }

            // Événements
            elements.searchBtn.addEventListener('click', searchWeather);
            elements.cityInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchWeather();
            });
            elements.musicToggle.addEventListener('click', toggleMusic);
            elements.languageSelect.addEventListener('change', changeLanguage);
            elements.hourlyTab.addEventListener('click', () => switchTab('hourly'));
            elements.sunTab.addEventListener('click', () => switchTab('sun'));
            elements.uvTab.addEventListener('click', () => switchTab('uv'));

            // Mettre à jour la langue dans le sélecteur
            elements.languageSelect.value = currentLanguage;

            // Traduire l'interface
            translateUI();

            // Obtenir la localisation de l'utilisateur
            getUserLocation();

            // Charger les actualités
            loadNews();

            // Actualiser les actualités toutes les 24 heures
            newsRefreshInterval = setInterval(loadNews, 24 * 60 * 60 * 1000);

            // Contourner la restriction d'autoplay
            document.body.addEventListener('click', () => {
                elements.bgMusic.play().catch(e => console.log("Musique:", e));
            }, { once: true });
        }

        // Changer d'onglet
        function switchTab(tab) {
            // Désactiver tous les onglets
            elements.hourlyTab.classList.remove('active');
            elements.sunTab.classList.remove('active');
            elements.uvTab.classList.remove('active');

            // Masquer tous les contenus
            elements.hourlyContent.style.display = 'none';
            elements.sunInfo.classList.remove('active');
            elements.uvInfo.classList.remove('active');

            // Activer l'onglet sélectionné
            if (tab === 'hourly') {
                elements.hourlyTab.classList.add('active');
                elements.hourlyContent.style.display = 'block';
            } else if (tab === 'sun') {
                elements.sunTab.classList.add('active');
                elements.sunInfo.classList.add('active');
                updateSunInfo();
            } else if (tab === 'uv') {
                elements.uvTab.classList.add('active');
                elements.uvInfo.classList.add('active');
                updateUVInfo();
            }
        }

        // Changer la langue
        function changeLanguage() {
            currentLanguage = elements.languageSelect.value;
            translateUI();

            // Si on a déjà des données météo, on les recharge avec la nouvelle langue
            if (userLocation) {
                getWeatherData(userLocation);
            } else if (elements.cityName.textContent !== translations[currentLanguage].loading) {
                getWeatherData(elements.cityName.textContent.split(',')[0]);
            }
        }

        // Traduire l'interface
        function translateUI() {
            const lang = translations[currentLanguage];

            // Titres et textes
            elements.appTitle.textContent = lang.appTitle;
            elements.cityInput.placeholder = lang.searchPlaceholder;
            elements.hourlyTab.innerHTML = `<i class="fas fa-clock"></i> ${lang.hourlyTab}`;
            elements.sunTab.innerHTML = `<i class="fas fa-sun"></i> ${lang.sunTab}`;
            elements.uvTab.innerHTML = `<i class="fas fa-sun"></i> ${lang.uvTab}`;

            // Mettre à jour le titre des actualités
            document.querySelector('.news-title').innerHTML = `<i class="fas fa-newspaper"></i> ${lang.newsTitle}`;

            // Si le texte actuel correspond à une traduction, on le met à jour
            if (elements.cityName.textContent === translations['fr'].loading) {
                elements.cityName.textContent = lang.loading;
            }

            if (elements.locationText.textContent === translations['fr'].locationText) {
                elements.locationText.textContent = lang.locationText;
            }

            // Mettre à jour les labels UV
            if (elements.uvInfo) {
                const uvRows = elements.uvInfo.querySelectorAll('.detail-row');
                uvRows[0].innerHTML = `<span>0-2</span><span>${lang.uvGuide["0-2"]}</span>`;
                uvRows[1].innerHTML = `<span>3-5</span><span>${lang.uvGuide["3-5"]}</span>`;
                uvRows[2].innerHTML = `<span>6-7</span><span>${lang.uvGuide["6-7"]}</span>`;
                uvRows[3].innerHTML = `<span>8-10</span><span>${lang.uvGuide["8-10"]}</span>`;
                uvRows[4].innerHTML = `<span>11+</span><span>${lang.uvGuide["11+"]}</span>`;
            }
        }

        // Obtenir la localisation de l'utilisateur
        function getUserLocation() {
            if (navigator.geolocation) {
                elements.locationText.textContent = translations[currentLanguage].locationText;

                navigator.geolocation.getCurrentPosition(
                    position => {
                        // Récupérer la ville à partir des coordonnées
                        getCityFromCoords(position.coords.latitude, position.coords.longitude);
                    },
                    error => {
                        console.error("Erreur de géolocalisation:", error);
                        elements.locationText.textContent = translations[currentLanguage].locationError;
                        // Démarrer avec Paris par défaut si la géolocalisation échoue
                        getWeatherData('Paris');
                    }
                );
            } else {
                elements.locationText.textContent = translations[currentLanguage].locationError;
                // Démarrer avec Paris par défaut si la géolocalisation n'est pas supportée
                getWeatherData('Paris');
            }
        }

        // Obtenir le nom de la ville à partir des coordonnées
        async function getCityFromCoords(lat, lon) {
            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${WEATHER_API_KEY}`
                );

                if (!response.ok) throw new Error('Ville non trouvée');

                const data = await response.json();
                userLocation = data.name;
                elements.locationText.textContent = translations[currentLanguage].locationFound.replace('{city}', data.name);
                getWeatherData(data.name);
            } catch (error) {
                console.error('Erreur:', error);
                elements.locationText.textContent = translations[currentLanguage].locationError;
                // Démarrer avec Paris par défaut si on ne peut pas obtenir la ville
                getWeatherData('Paris');
            }
        }

        // Recherche météo
        function searchWeather() {
            const city = elements.cityInput.value.trim();
            if (city) {
                userLocation = city;
                getWeatherData(city);
            }
        }

        // Obtenir les données météo
        async function getWeatherData(city) {
            try {
                elements.cityName.textContent = translations[currentLanguage].loading;

                // Effacer les intervalles précédents
                if (refreshInterval) clearInterval(refreshInterval);
                if (forecastRefreshInterval) clearInterval(forecastRefreshInterval);

                // Météo actuelle
                const currentResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${WEATHER_API_KEY}&lang=${currentLanguage}`
                );

                if (!currentResponse.ok) throw new Error(translations[currentLanguage].locationError);

                const currentData = await currentResponse.json();
                currentWeatherData = currentData;
                updateWeatherUI(currentData);

                // Prévisions sur 5 jours
                const forecastResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${WEATHER_API_KEY}&lang=${currentLanguage}`
                );

                const forecastDataResponse = await forecastResponse.json();
                forecastData = forecastDataResponse.list;
                updateHourlyForecast(forecastData);
                updateDailyForecast(forecastData);
                updateSunInfo();
                updateUVInfo();

                // Actualiser la température toutes les 1 minute
                refreshInterval = setInterval(() => {
                    updateWeatherUI(currentWeatherData);
                }, 60000); // 1 minute

                // Actualiser les prévisions toutes les 3 heures
                forecastRefreshInterval = setInterval(async () => {
                    const forecastResponse = await fetch(
                        `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${WEATHER_API_KEY}&lang=${currentLanguage}`
                    );
                    const forecastDataResponse = await forecastResponse.json();
                    forecastData = forecastDataResponse.list;
                    updateHourlyForecast(forecastData);
                    updateDailyForecast(forecastData);
                }, 10800000); // 3 heures

            } catch (error) {
                alert(error.message);
                console.error('Erreur:', error);
            }
        }

        // Mettre à jour les prévisions horaires avec les heures spécifiques
        function updateHourlyForecast(forecastList) {
            // Grouper les prévisions par jour
            const forecastsByDay = {};
            forecastList.forEach(item => {
                const date = new Date(item.dt * 1000);
                const day = date.toLocaleDateString();
                if (!forecastsByDay[day]) {
                    forecastsByDay[day] = [];
                }
                forecastsByDay[day].push(item);
            });

            // Créer les onglets de jours
            elements.dayNavigation.innerHTML = '';
            Object.keys(forecastsByDay).forEach((day, index) => {
                const dayTab = document.createElement('div');
                dayTab.className = `day-tab ${index === 0 ? 'active' : ''}`;
                const date = new Date(forecastsByDay[day][0].dt * 1000);
                const dayName = weekDays[date.getDay()];
                dayTab.textContent = `${dayName} ${date.getDate()}/${date.getMonth() + 1}`;
                dayTab.addEventListener('click', () => {
                    // Active l'onglet
                    document.querySelectorAll('.day-tab').forEach(tab => tab.classList.remove('active'));
                    dayTab.classList.add('active');
                    // Affiche les prévisions du jour
                    displayHourlyForecast(forecastsByDay[day]);
                });
                elements.dayNavigation.appendChild(dayTab);
            });

            // Afficher le premier jour par défaut
            if (Object.keys(forecastsByDay).length > 0) {
                displayHourlyForecast(forecastsByDay[Object.keys(forecastsByDay)[0]]);
            }
        }

        function displayHourlyForecast(dayForecasts) {
            elements.hourlyForecast.innerHTML = '';
            dayForecasts.forEach(item => {
                const date = new Date(item.dt * 1000);
                const hours = date.getHours().toString().padStart(2, '0');
                const minutes = date.getMinutes().toString().padStart(2, '0');
                const temp = item.main.temp;
                const icon = item.weather[0].icon;
                const windSpeed = item.wind.speed * 3.6; // Convertir en km/h
                const humidity = item.main.humidity;
                const rain = item.rain ? item.rain['3h'] || 0 : 0;

                const hourElement = document.createElement('div');
                hourElement.className = 'hour-item';
                hourElement.innerHTML = `
                    <div class="hour-time">${hours}:${minutes}</div>
                    <div class="hour-icon"><i class="fas ${weatherIcons[icon] || 'fa-question'}"></i></div>
                    <div class="hour-temp">${Math.round(temp)}°</div>
                    <div class="hour-details">
                        <div><i class="fas fa-wind"></i> ${Math.round(windSpeed)} km/h</div>
                        <div><i class="fas fa-tint"></i> ${humidity}%</div>
                        ${rain > 0 ? `<div><i class="fas fa-cloud-rain"></i> ${rain} mm</div>` : ''}
                    </div>
                `;
                elements.hourlyForecast.appendChild(hourElement);
            });
        }

        // Mettre à jour les prévisions sur 5 jours
        function updateDailyForecast(forecastList) {
            elements.dailyForecast.innerHTML = '';

            // Grouper par jour
            const dailyForecasts = {};

            forecastList.forEach(item => {
                const date = new Date(item.dt * 1000);
                const dayKey = date.toLocaleDateString();

                if (!dailyForecasts[dayKey]) {
                    dailyForecasts[dayKey] = [];
                }

                dailyForecasts[dayKey].push(item);
            });

            // Prendre les 5 prochains jours (aujourd'hui + 4 jours suivants)
            const next5Days = Object.keys(dailyForecasts).slice(0, 5);

            next5Days.forEach(dayKey => {
                const dayForecasts = dailyForecasts[dayKey];
                const date = new Date(dayForecasts[0].dt * 1000);

                // Calculer la température moyenne et trouver l'icône la plus représentative
                let totalTemp = 0;
                let iconCounts = {};

                dayForecasts.forEach(forecast => {
                    totalTemp += forecast.main.temp;

                    const icon = forecast.weather[0].icon;
                    iconCounts[icon] = (iconCounts[icon] || 0) + 1;
                });

                const avgTemp = Math.round(totalTemp / dayForecasts.length);

                // Trouver l'icône la plus fréquente
                let mostFrequentIcon = Object.keys(iconCounts).reduce((a, b) =>
                    iconCounts[a] > iconCounts[b] ? a : b
                );

                // Créer l'élément du jour
                const dayElement = document.createElement('div');
                dayElement.className = 'day-item';
                dayElement.dataset.date = dayKey;

                // Formater la date (ex: "Lun 1/7")
                const dayName = weekDays[date.getDay()];
                const dayNumber = date.getDate();
                const monthNumber = date.getMonth() + 1;

                dayElement.innerHTML = `
                    <div class="day-name">${dayName}</div>
                    <div class="day-date">${dayNumber}/${monthNumber}</div>
                    <div class="day-icon"><i class="fas ${weatherIcons[mostFrequentIcon] || 'fa-question'}"></i></div>
                    <div class="day-temp">${avgTemp}°</div>
                `;

                // Ajouter un gestionnaire d'événements pour détecter les clics
                dayElement.addEventListener('click', () => {
                    // Activer l'onglet du jour correspondant
                    document.querySelectorAll('.day-tab').forEach(tab => {
                        if (tab.textContent.includes(dayName)) {
                            tab.click();
                        }
                    });
                });

                elements.dailyForecast.appendChild(dayElement);
            });
        }

        // Mettre à jour les infos soleil/lune
        function updateSunInfo() {
            if (!currentWeatherData) return;

            const lang = translations[currentLanguage];

            // Heures de lever/coucher du soleil
            const sunrise = new Date(currentWeatherData.sys.sunrise * 1000);
            const sunset = new Date(currentWeatherData.sys.sunset * 1000);

            elements.sunriseValue.textContent = sunrise.toLocaleTimeString(currentLanguage, { hour: '2-digit', minute: '2-digit' });
            elements.sunsetValue.textContent = sunset.toLocaleTimeString(currentLanguage, { hour: '2-digit', minute: '2-digit' });

            // Durée du jour
            const daylightMs = sunset - sunrise;
            const daylightHours = Math.floor(daylightMs / (1000 * 60 * 60));
            const daylightMinutes = Math.floor((daylightMs % (1000 * 60 * 60)) / (1000 * 60));
            elements.daylightValue.textContent = `${daylightHours}h ${daylightMinutes}m`;

            // Phase lunaire (simulée)
            const moonAge = (Date.now() / (1000 * 60 * 60 * 24) + 9) % 29.53; // Age lunaire en jours
            const moonPhaseIndex = Math.floor((moonAge / 29.53) * 8) % 8;
            elements.moonPhase.textContent = moonPhases[moonPhaseIndex];
        }

        // Mettre à jour les infos UV
        function updateUVInfo() {
            if (!currentWeatherData) return;

            const lang = translations[currentLanguage];

            // Simuler un indice UV basé sur l'heure et la météo
            const now = new Date();
            const hour = now.getHours();
            const isDaytime = hour >= 6 && hour <= 18;
            const weather = currentWeatherData.weather[0].main.toLowerCase();

            let uvValue;
            let uvClass = 'uv-low';
            let uvLabel = lang.uvLabels.low;

            // Logique simplifiée pour déterminer l'UV
            if (weather.includes('clear') && isDaytime) {
                // Ensoleillé en journée = UV élevé
                if (hour >= 10 && hour <= 14) {
                    // Heures de fort ensoleillement
                    uvValue = Math.floor(Math.random() * 3) + 8; // 8-10
                    uvClass = 'uv-very-high';
                    uvLabel = lang.uvLabels.veryHigh;
                } else {
                    // Autres heures ensoleillées
                    uvValue = Math.floor(Math.random() * 3) + 5; // 5-7
                    uvClass = 'uv-high';
                    uvLabel = lang.uvLabels.high;
                }
            } else if (weather.includes('cloud') && isDaytime) {
                // Nuageux en journée = UV modéré
                uvValue = Math.floor(Math.random() * 3) + 3; // 3-5
                uvClass = 'uv-moderate';
                uvLabel = lang.uvLabels.moderate;
            } else if (isDaytime) {
                // Autres conditions de jour
                uvValue = Math.floor(Math.random() * 3) + 2; // 2-4
                uvClass = 'uv-low';
                uvLabel = lang.uvLabels.low;
            } else {
                // Nuit = pas d'UV
                uvValue = 0;
                uvClass = 'uv-low';
                uvLabel = lang.uvLabels.low;
            }

            // Mettre à jour l'interface
            elements.uvIndex.textContent = uvValue;
            elements.uvValue.textContent = uvValue;
            elements.uvValue.className = `uv-value ${uvClass}`;
            elements.uvLabel.textContent = uvLabel;
        }

        // Mettre à jour l'interface
        function updateWeatherUI(data) {
            elements.cityName.textContent = `${data.name}, ${data.sys.country}`;
            elements.temp.textContent = Math.round(data.main.temp);
            elements.weatherDesc.textContent = data.weather[0].description;
            elements.humidity.textContent = `${data.main.humidity}%`;
            elements.feelsLike.textContent = `${Math.round(data.main.feels_like)}°C`;
            elements.visibility.textContent = `${(data.visibility / 1000).toFixed(1)} km`;
            elements.pressure.textContent = `${data.main.pressure} hPa`;
            
            // Altitude simulée (l'API OpenWeather ne fournit pas cette information)
            // Nous utilisons une valeur aléatoire réaliste pour l'exemple
            const altitude = Math.floor(Math.random() * 300) + 50; // Entre 50 et 350 mètres
            elements.altitude.textContent = `${altitude} m`;

            // Mettre à jour l'icône
            const iconCode = data.weather[0].icon;
            elements.weatherIcon.className = `fas ${weatherIcons[iconCode] || 'fa-question'}`;

            // Mettre à jour le vent
            updateWindInfo(data.wind);

            // Mettre à jour l'indice UV
            updateUVInfo();
        }

        // Mettre à jour les informations sur le vent
        function updateWindInfo(windData) {
            const lang = translations[currentLanguage];
            const speed = Math.round(windData.speed * 3.6); // Convertir m/s en km/h
            
            // Déterminer la direction du vent si elle est disponible
            let direction = '';
            if (windData.deg !== undefined) {
                // Convertir les degrés en direction cardinale
                const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
                const index = Math.round(windData.deg / 22.5) % 16;
                const cardinalDirection = directions[index];
                direction = lang.windDirections[cardinalDirection] || cardinalDirection;
            }

            // Créer l'élément de direction du vent
            let windHtml = `${speed} km/h`;
            if (direction) {
                windHtml += ` <span class="wind-direction" style="transform: rotate(${windData.deg}deg)"></span> ${direction}`;
            }

            elements.wind.innerHTML = windHtml;
        }

        // Charger les actualités
        async function loadNews() {
            try {
                // En production, vous utiliseriez une vraie API d'actualités
                // Exemple avec NewsAPI (nécessite une clé API)
                // const response = await fetch(`https://newsapi.org/v2/top-headlines?country=fr&apiKey=${NEWS_API_KEY}`);
                
                // Pour cet exemple, nous utilisons des données simulées
                const newsData = [
                    {
                        title: "Nouvelle avancée dans la recherche climatique",
                        description: "Les scientifiques ont fait une découverte majeure dans la compréhension des changements climatiques.",
                        url: "#"
                    },
                    {
                        title: "Record de température enregistré cet été",
                        description: "Les températures ont atteint des niveaux historiques dans plusieurs régions du pays.",
                        url: "#"
                    },
                    {
                        title: "Lancement d'un nouveau satellite météorologique",
                        description: "Ce satellite permettra des prévisions plus précises et une meilleure surveillance des phénomènes météorologiques.",
                        url: "#"
                    }
                ];

                displayNews(newsData);
            } catch (error) {
                console.error("Erreur lors du chargement des actualités:", error);
                
                // Afficher des actualités par défaut en cas d'erreur
                const defaultNews = [
                    {
                        title: "Actualité météo du jour",
                        description: "Restez informé des dernières prévisions météorologiques pour votre région.",
                        url: "#"
                    },
                    {
                        title: "Conseils pour faire face aux fortes chaleurs",
                        description: "Découvrez comment protéger votre santé pendant les périodes de canicule.",
                        url: "#"
                    }
                ];
                
                displayNews(defaultNews);
            }
        }

        // Afficher les actualités
        function displayNews(newsItems) {
            elements.newsList.innerHTML = '';
            
            newsItems.slice(0, 3).forEach(item => {
                const newsElement = document.createElement('div');
                newsElement.className = 'news-item';
                newsElement.innerHTML = `
                    <h3>${item.title}</h3>
                    <p>${item.description}</p>
                    <a href="${item.url}" target="_blank">Lire la suite <i class="fas fa-external-link-alt"></i></a>
                `;
                elements.newsList.appendChild(newsElement);
            });
        }

        // Contrôle musique
        function toggleMusic() {
            if (elements.bgMusic.paused) {
                elements.bgMusic.play();
                elements.musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
            } else {
                elements.bgMusic.pause();
                elements.musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
        }

        // Démarrer l'application
        init();
    </script>
</body>
</html>