<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Météo Vision 360°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }
        
        body {
            overflow: hidden;
            height: 100vh;
            position: relative;
        }
        
        #video-bg {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
            object-fit: cover;
            opacity: 0.8;
        }
        
        .app-container {
            position: relative;
            z-index: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.5);
            color: white;
        }
        
        .header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .search-container {
            display: flex;
            gap: 10px;
        }
        
        #city-input {
            padding: 12px 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            outline: none;
            width: 200px;
            transition: all 0.3s;
        }
        
        #city-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        #city-input:focus {
            background: rgba(255, 255, 255, 0.3);
            width: 250px;
        }
        
        #search-btn {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #search-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            text-align: center;
            overflow-y: auto;
        }
        
        .current-weather {
            margin-bottom: 20px;
            width: 100%;
        }
        
        #city-name {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .weather-main {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        #weather-icon {
            font-size: 80px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        #temp {
            font-size: 72px;
            font-weight: 300;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        #weather-desc {
            font-size: 24px;
            margin-bottom: 15px;
            text-transform: capitalize;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .weather-details {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .detail {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            min-width: 100px;
            backdrop-filter: blur(5px);
        }
        
        .detail i {
            font-size: 24px;
            margin-bottom: 5px;
            color: #4cc9f0;
        }
        
        .detail span {
            display: block;
            font-size: 18px;
        }
        
        .forecast-container {
            width: 100%;
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(5px);
        }
        
        .forecast-title {
            font-size: 20px;
            margin-bottom: 15px;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .forecast-title i {
            color: #4cc9f0;
        }
        
        .forecast-days {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .forecast-day {
            min-width: 80px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .forecast-day:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }
        
        .forecast-day.active {
            background: rgba(76, 201, 240, 0.3);
            border: 1px solid #4cc9f0;
        }
        
        .day-name {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .day-icon {
            font-size: 30px;
            margin: 5px 0;
            color: #ffd700;
        }
        
        .day-temp {
            font-weight: 500;
        }
        
        .day-details {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            text-align: left;
        }
        
        .day-details.active {
            display: block;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .music-control {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .music-control:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .music-control i {
            font-size: 20px;
            color: white;
        }
        
        .location-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 14px;
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .location-info i {
            color: #4cc9f0;
        }
        
        .lang-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 25px;
            font-size: 14px;
            backdrop-filter: blur(5px);
            z-index: 10;
        }
        
        #language-select {
            background: transparent;
            border: none;
            color: white;
            outline: none;
        }
        
        #language-select option {
            background: rgba(0, 0, 0, 0.8);
            color: white;
        }
        
        @media (max-width: 600px) {
            #city-name {
                font-size: 26px;
            }
            
            #temp {
                font-size: 60px;
            }
            
            .forecast-day {
                min-width: 70px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .lang-selector {
                top: 10px;
                right: 10px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Fond vidéo animé -->
    <video autoplay muted loop id="video-bg">
        <source src="Live Wallpaper Anime HD4K - Samurai Autumn.mp4" type="video/mp4">
    </video>
    
    <!-- Musique d'ambiance -->
    <audio autoplay loop id="bg-music">
        <source src="AURA of GLORY (Super Slowed).mp3" type="audio/mpeg">
    </audio>
    
    <!-- Contrôle musique -->
    <div class="music-control" id="music-toggle">
        <i class="fas fa-music"></i>
    </div>
    
    <!-- Sélecteur de langue -->
    <div class="lang-selector">
        <select id="language-select">
            <option value="fr">Français</option>
            <option value="en">English</option>
            <option value="es">Español</option>
            <option value="de">Deutsch</option>
            <option value="it">Italiano</option>
            <option value="pt">Português</option>
            <option value="ru">Русский</option>
            <option value="zh">中文</option>
            <option value="ja">日本語</option>
            <option value="ar">العربية</option>
        </select>
    </div>
    
    <!-- Application météo -->
    <div class="app-container">
        <header class="header">
            <h1 id="app-title">Météo Vision</h1>
            <div class="search-container">
                <input type="text" id="city-input" placeholder="Rechercher une ville...">
                <button id="search-btn"><i class="fas fa-search"></i></button>
            </div>
        </header>
        
        <main class="main-content">
            <div class="current-weather">
                <h2 id="city-name">Chargement...</h2>
                <div class="weather-main">
                    <div id="weather-icon"><i class="fas fa-sun"></i></div>
                    <div><span id="temp">--</span>°</div>
                </div>
                <p id="weather-desc">--</p>
                
                <div class="weather-details">
                    <div class="detail">
                        <i class="fas fa-tint"></i>
                        <span id="humidity">--%</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-wind"></i>
                        <span id="wind">-- km/h</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-temperature-low"></i>
                        <span id="feels-like">--°C</span>
                    </div>
                    <div class="detail">
                        <i class="fas fa-eye"></i>
                        <span id="visibility">-- km</span>
                    </div>
                </div>
            </div>
            
            <!-- Prévisions 5 jours -->
            <div class="forecast-container">
                <h3 class="forecast-title"><i class="fas fa-calendar-alt"></i> <span id="forecast-title">Prévisions 5 jours</span></h3>
                <div class="forecast-days" id="forecast-days">
                    <!-- Les jours seront ajoutés ici par JavaScript -->
                </div>
                
                <!-- Détails du jour sélectionné -->
                <div class="day-details" id="day-details">
                    <div class="detail-row">
                        <span id="morning-label">Matin</span>
                        <span><i class="fas fa-cloud-sun"></i> <span id="morning-temp">18°C</span></span>
                    </div>
                    <div class="detail-row">
                        <span id="afternoon-label">Après-midi</span>
                        <span><i class="fas fa-sun"></i> <span id="afternoon-temp">24°C</span></span>
                    </div>
                    <div class="detail-row">
                        <span id="evening-label">Soir</span>
                        <span><i class="fas fa-cloud-moon"></i> <span id="evening-temp">20°C</span></span>
                    </div>
                    <div class="detail-row">
                        <span id="night-label">Nuit</span>
                        <span><i class="fas fa-moon"></i> <span id="night-temp">16°C</span></span>
                    </div>
                    <div class="detail-row">
                        <span id="precipitation-label">Précipitations</span>
                        <span id="precipitation-value">20%</span>
                    </div>
                    <div class="detail-row">
                        <span id="wind-label">Vent</span>
                        <span id="wind-value">15 km/h</span>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Info de localisation -->
        <div class="location-info" id="location-info">
            <i class="fas fa-map-marker-alt"></i>
            <span id="location-text">Localisation en cours...</span>
        </div>
    </div>

    <script>
        // Configuration API
        const API_KEY = 'eb29384628c0ba8611b8df0ef02a7377';
        
        // Éléments du DOM
        const elements = {
            cityInput: document.getElementById('city-input'),
            searchBtn: document.getElementById('search-btn'),
            cityName: document.getElementById('city-name'),
            weatherIcon: document.getElementById('weather-icon'),
            temp: document.getElementById('temp'),
            weatherDesc: document.getElementById('weather-desc'),
            humidity: document.getElementById('humidity'),
            wind: document.getElementById('wind'),
            feelsLike: document.getElementById('feels-like'),
            visibility: document.getElementById('visibility'),
            musicToggle: document.getElementById('music-toggle'),
            bgMusic: document.getElementById('bg-music'),
            videoBg: document.getElementById('video-bg'),
            forecastDays: document.getElementById('forecast-days'),
            dayDetails: document.getElementById('day-details'),
            locationInfo: document.getElementById('location-info'),
            locationText: document.getElementById('location-text'),
            languageSelect: document.getElementById('language-select'),
            appTitle: document.getElementById('app-title'),
            forecastTitle: document.getElementById('forecast-title')
        };
        
        // Icônes météo
        const weatherIcons = {
            '01d': 'fa-sun',           // ciel clair (jour)
            '01n': 'fa-moon',          // ciel clair (nuit)
            '02d': 'fa-cloud-sun',     // quelques nuages (jour)
            '02n': 'fa-cloud-moon',    // quelques nuages (nuit)
            '03d': 'fa-cloud',         // nuages dispersés
            '03n': 'fa-cloud',
            '04d': 'fa-cloud',         // nuages brisés
            '04n': 'fa-cloud',
            '09d': 'fa-cloud-rain',    // pluie légère
            '09n': 'fa-cloud-rain',
            '10d': 'fa-cloud-showers-heavy', // pluie
            '10n': 'fa-cloud-showers-heavy',
            '11d': 'fa-bolt',         // orage
            '11n': 'fa-bolt',
            '13d': 'fa-snowflake',    // neige
            '13n': 'fa-snowflake',
            '50d': 'fa-smog',         // brouillard
            '50n': 'fa-smog'
        };
        
        // Traductions
        const translations = {
            fr: {
                appTitle: "Météo Vision",
                searchPlaceholder: "Rechercher une ville...",
                loading: "Chargement...",
                forecastTitle: "Prévisions 5 jours",
                morning: "Matin",
                afternoon: "Après-midi",
                evening: "Soir",
                night: "Nuit",
                precipitation: "Précipitations",
                wind: "Vent",
                locationText: "Localisation en cours...",
                locationFound: "Vous êtes à {city}",
                locationError: "Localisation non disponible"
            },
            en: {
                appTitle: "Weather Vision",
                searchPlaceholder: "Search for a city...",
                loading: "Loading...",
                forecastTitle: "5-day forecast",
                morning: "Morning",
                afternoon: "Afternoon",
                evening: "Evening",
                night: "Night",
                precipitation: "Precipitation",
                wind: "Wind",
                locationText: "Locating...",
                locationFound: "You are in {city}",
                locationError: "Location not available"
            },
            es: {
                appTitle: "Visión del Tiempo",
                searchPlaceholder: "Buscar una ciudad...",
                loading: "Cargando...",
                forecastTitle: "Pronóstico 5 días",
                morning: "Mañana",
                afternoon: "Tarde",
                evening: "Noche",
                night: "Noche",
                precipitation: "Precipitación",
                wind: "Viento",
                locationText: "Localizando...",
                locationFound: "Estás en {city}",
                locationError: "Ubicación no disponible"
            },
            de: {
                appTitle: "Wetter Vision",
                searchPlaceholder: "Suche nach einer Stadt...",
                loading: "Laden...",
                forecastTitle: "5-Tage-Vorhersage",
                morning: "Morgen",
                afternoon: "Nachmittag",
                evening: "Abend",
                night: "Nacht",
                precipitation: "Niederschlag",
                wind: "Wind",
                locationText: "Ortung...",
                locationFound: "Sie sind in {city}",
                locationError: "Standort nicht verfügbar"
            },
            it: {
                appTitle: "Visione Meteo",
                searchPlaceholder: "Cerca una città...",
                loading: "Caricamento...",
                forecastTitle: "Previsioni 5 giorni",
                morning: "Mattina",
                afternoon: "Pomeriggio",
                evening: "Sera",
                night: "Notte",
                precipitation: "Precipitazioni",
                wind: "Vento",
                locationText: "Localizzazione...",
                locationFound: "Sei a {city}",
                locationError: "Posizione non disponibile"
            },
            pt: {
                appTitle: "Visão do Tempo",
                searchPlaceholder: "Pesquisar cidade...",
                loading: "Carregando...",
                forecastTitle: "Previsão 5 dias",
                morning: "Manhã",
                afternoon: "Tarde",
                evening: "Noite",
                night: "Noite",
                precipitation: "Precipitação",
                wind: "Vento",
                locationText: "Localizando...",
                locationFound: "Você está em {city}",
                locationError: "Localização não disponível"
            },
            ru: {
                appTitle: "Погода Видение",
                searchPlaceholder: "Поиск города...",
                loading: "Загрузка...",
                forecastTitle: "Прогноз на 5 дней",
                morning: "Утро",
                afternoon: "День",
                evening: "Вечер",
                night: "Ночь",
                precipitation: "Осадки",
                wind: "Ветер",
                locationText: "Определение местоположения...",
                locationFound: "Вы находитесь в {city}",
                locationError: "Местоположение недоступно"
            },
            zh: {
                appTitle: "天气视觉",
                searchPlaceholder: "搜索城市...",
                loading: "加载中...",
                forecastTitle: "5天预报",
                morning: "早晨",
                afternoon: "下午",
                evening: "晚上",
                night: "夜晚",
                precipitation: "降水",
                wind: "风",
                locationText: "定位中...",
                locationFound: "您在{city}",
                locationError: "位置不可用"
            },
            ja: {
                appTitle: "天気ビジョン",
                searchPlaceholder: "都市を検索...",
                loading: "読み込み中...",
                forecastTitle: "5日間の予報",
                morning: "朝",
                afternoon: "午後",
                evening: "夕方",
                night: "夜",
                precipitation: "降水",
                wind: "風",
                locationText: "位置情報を取得中...",
                locationFound: "あなたは{city}にいます",
                locationError: "位置情報が利用できません"
            },
            ar: {
                appTitle: "رؤية الطقس",
                searchPlaceholder: "ابحث عن مدينة...",
                loading: "جار التحميل...",
                forecastTitle: "تنبؤات 5 أيام",
                morning: "صباحاً",
                afternoon: "ظهراً",
                evening: "مساءً",
                night: "ليلاً",
                precipitation: "هطول",
                wind: "رياح",
                locationText: "جاري تحديد الموقع...",
                locationFound: "أنت في {city}",
                locationError: "الموقع غير متاح"
            }
        };
        
        // Données de prévision
        let forecastData = [];
        let currentDayIndex = 0;
        let currentLanguage = 'fr';
        let userLocation = null;
        
        // Initialisation
        function init() {
            // Détecter la langue du navigateur
            const browserLang = navigator.language || navigator.userLanguage;
            currentLanguage = browserLang.split('-')[0];
            if (!translations[currentLanguage]) {
                currentLanguage = 'fr'; // Fallback to French
            }
            
            // Événements
            elements.searchBtn.addEventListener('click', searchWeather);
            elements.cityInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchWeather();
            });
            elements.musicToggle.addEventListener('click', toggleMusic);
            elements.languageSelect.addEventListener('change', changeLanguage);
            
            // Mettre à jour la langue dans le sélecteur
            elements.languageSelect.value = currentLanguage;
            
            // Traduire l'interface
            translateUI();
            
            // Obtenir la localisation de l'utilisateur
            getUserLocation();
            
            // Contourner la restriction d'autoplay
            document.body.addEventListener('click', () => {
                elements.bgMusic.play().catch(e => console.log("Musique:", e));
                elements.videoBg.play().catch(e => console.log("Vidéo:", e));
            }, { once: true });
        }
        
        // Changer la langue
        function changeLanguage() {
            currentLanguage = elements.languageSelect.value;
            translateUI();
            
            // Si on a déjà des données météo, on les recharge avec la nouvelle langue
            if (userLocation) {
                getWeatherData(userLocation);
            } else if (elements.cityName.textContent !== translations[currentLanguage].loading) {
                getWeatherData(elements.cityName.textContent.split(',')[0]);
            }
        }
        
        // Traduire l'interface
        function translateUI() {
            const lang = translations[currentLanguage];
            
            // Titres et textes
            elements.appTitle.textContent = lang.appTitle;
            elements.cityInput.placeholder = lang.searchPlaceholder;
            elements.forecastTitle.textContent = lang.forecastTitle;
            
            // Si le texte actuel correspond à une traduction, on le met à jour
            if (elements.cityName.textContent === translations['fr'].loading) {
                elements.cityName.textContent = lang.loading;
            }
            
            if (elements.locationText.textContent === translations['fr'].locationText) {
                elements.locationText.textContent = lang.locationText;
            }
        }
        
        // Obtenir la localisation de l'utilisateur
        function getUserLocation() {
            if (navigator.geolocation) {
                elements.locationText.textContent = translations[currentLanguage].locationText;
                
                navigator.geolocation.getCurrentPosition(
                    position => {
                        // Récupérer la ville à partir des coordonnées
                        getCityFromCoords(position.coords.latitude, position.coords.longitude);
                    },
                    error => {
                        console.error("Erreur de géolocalisation:", error);
                        elements.locationText.textContent = translations[currentLanguage].locationError;
                        // Démarrer avec Paris par défaut si la géolocalisation échoue
                        getWeatherData('Paris');
                    }
                );
            } else {
                elements.locationText.textContent = translations[currentLanguage].locationError;
                // Démarrer avec Paris par défaut si la géolocalisation n'est pas supportée
                getWeatherData('Paris');
            }
        }
        
        // Obtenir le nom de la ville à partir des coordonnées
        async function getCityFromCoords(lat, lon) {
            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}`
                );
                
                if (!response.ok) throw new Error('Ville non trouvée');
                
                const data = await response.json();
                userLocation = data.name;
                elements.locationText.textContent = translations[currentLanguage].locationFound.replace('{city}', data.name);
                getWeatherData(data.name);
            } catch (error) {
                console.error('Erreur:', error);
                elements.locationText.textContent = translations[currentLanguage].locationError;
                // Démarrer avec Paris par défaut si on ne peut pas obtenir la ville
                getWeatherData('Paris');
            }
        }
        
        // Recherche météo
        function searchWeather() {
            const city = elements.cityInput.value.trim();
            if (city) {
                userLocation = city;
                getWeatherData(city);
            }
        }
        
        // Obtenir les données météo
        async function getWeatherData(city) {
            try {
                elements.cityName.textContent = translations[currentLanguage].loading;
                
                // Météo actuelle
                const currentResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${API_KEY}&lang=${currentLanguage}`
                );
                
                if (!currentResponse.ok) throw new Error(translations[currentLanguage].locationError);
                
                const currentData = await currentResponse.json();
                updateWeatherUI(currentData);
                
                // Prévisions sur 5 jours
                const forecastResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${API_KEY}&lang=${currentLanguage}`
                );
                
                const forecastDataResponse = await forecastResponse.json();
                forecastData = processForecastData(forecastDataResponse);
                displayForecastDays();
                displayDayDetails(0); // Afficher les détails du premier jour par défaut
                
            } catch (error) {
                alert(error.message);
                console.error('Erreur:', error);
            }
        }
        
        // Traiter les données de prévision
        function processForecastData(data) {
            const dailyForecasts = [];
            const days = {};
            
            // Grouper par jour
            data.list.forEach(item => {
                const date = new Date(item.dt * 1000);
                const dayKey = date.toLocaleDateString('fr-FR');
                
                if (!days[dayKey]) {
                    days[dayKey] = {
                        date: date,
                        items: []
                    };
                }
                
                days[dayKey].items.push(item);
            });
            
            // Extraire les prévisions pour chaque jour (midi si possible)
            Object.keys(days).slice(0, 5).forEach(dayKey => {
                const dayData = days[dayKey];
                let bestForecast = dayData.items[0];
                
                // Trouver la prévision la plus proche de midi
                dayData.items.forEach(item => {
                    const itemHour = new Date(item.dt * 1000).getHours();
                    const bestHour = new Date(bestForecast.dt * 1000).getHours();
                    
                    if (Math.abs(itemHour - 12) < Math.abs(bestHour - 12)) {
                        bestForecast = item;
                    }
                });
                
                dailyForecasts.push({
                    date: dayData.date,
                    data: bestForecast,
                    allItems: dayData.items
                });
            });
            
            return dailyForecasts;
        }
        
        // Afficher les jours de prévision
        function displayForecastDays() {
            elements.forecastDays.innerHTML = '';
            
            forecastData.forEach((day, index) => {
                const dayElement = document.createElement('div');
                dayElement.className = `forecast-day ${index === currentDayIndex ? 'active' : ''}`;
                
                // Formater le nom du jour selon la langue
                const dayName = day.date.toLocaleDateString(currentLanguage, { weekday: 'short' });
                
                dayElement.innerHTML = `
                    <div class="day-name">${dayName}</div>
                    <div class="day-icon"><i class="fas ${weatherIcons[day.data.weather[0].icon] || 'fa-question'}"></i></div>
                    <div class="day-temp">${Math.round(day.data.main.temp)}°</div>
                `;
                
                dayElement.addEventListener('click', () => {
                    document.querySelector('.forecast-day.active')?.classList.remove('active');
                    dayElement.classList.add('active');
                    currentDayIndex = index;
                    displayDayDetails(index);
                });
                
                elements.forecastDays.appendChild(dayElement);
            });
        }
        
        // Afficher les détails du jour sélectionné
        function displayDayDetails(dayIndex) {
            const lang = translations[currentLanguage];
            const day = forecastData[dayIndex];
            const morning = findClosestForecast(day.allItems, 9); // 9h
            const afternoon = findClosestForecast(day.allItems, 15); // 15h
            const evening = findClosestForecast(day.allItems, 21); // 21h
            const night = findClosestForecast(day.allItems, 3); // 3h du matin
            
            elements.dayDetails.innerHTML = `
                <div class="detail-row">
                    <span>${lang.morning}</span>
                    <span><i class="fas ${morning ? weatherIcons[morning.weather[0].icon] : 'fa-question'}"></i> ${morning ? Math.round(morning.main.temp) + '°C' : '--'}</span>
                </div>
                <div class="detail-row">
                    <span>${lang.afternoon}</span>
                    <span><i class="fas ${afternoon ? weatherIcons[afternoon.weather[0].icon] : 'fa-question'}"></i> ${afternoon ? Math.round(afternoon.main.temp) + '°C' : '--'}</span>
                </div>
                <div class="detail-row">
                    <span>${lang.evening}</span>
                    <span><i class="fas ${evening ? weatherIcons[evening.weather[0].icon] : 'fa-question'}"></i> ${evening ? Math.round(evening.main.temp) + '°C' : '--'}</span>
                </div>
                <div class="detail-row">
                    <span>${lang.night}</span>
                    <span><i class="fas ${night ? weatherIcons[night.weather[0].icon] : 'fa-question'}"></i> ${night ? Math.round(night.main.temp) + '°C' : '--'}</span>
                </div>
                <div class="detail-row">
                    <span>${lang.precipitation}</span>
                    <span>${day.data.pop ? Math.round(day.data.pop * 100) + '%' : '0%'}</span>
                </div>
                <div class="detail-row">
                    <span>${lang.wind}</span>
                    <span>${Math.round(day.data.wind.speed * 3.6)} km/h</span>
                </div>
            `;
            
            elements.dayDetails.classList.add('active');
        }
        
        // Trouver la prévision la plus proche d'une heure spécifique
        function findClosestForecast(forecasts, targetHour) {
            if (!forecasts || forecasts.length === 0) return null;
            
            let closest = forecasts[0];
            let closestDiff = 24;
            
            forecasts.forEach(forecast => {
                const forecastHour = new Date(forecast.dt * 1000).getHours();
                const diff = Math.min(
                    Math.abs(forecastHour - targetHour),
                    24 - Math.abs(forecastHour - targetHour)
                );
                
                if (diff < closestDiff) {
                    closestDiff = diff;
                    closest = forecast;
                }
            });
            
            return closest;
        }
        
        // Mettre à jour l'interface
        function updateWeatherUI(data) {
            elements.cityName.textContent = `${data.name}, ${data.sys.country}`;
            elements.temp.textContent = Math.round(data.main.temp);
            elements.weatherDesc.textContent = data.weather[0].description;
            elements.humidity.textContent = `${data.main.humidity}%`;
            elements.wind.textContent = `${Math.round(data.wind.speed * 3.6)} km/h`;
            elements.feelsLike.textContent = `${Math.round(data.main.feels_like)}°C`;
            elements.visibility.textContent = `${(data.visibility / 1000).toFixed(1)} km`;
            
            // Mettre à jour l'icône
            const iconCode = data.weather[0].icon;
            elements.weatherIcon.className = `fas ${weatherIcons[iconCode] || 'fa-question'}`;
        }
        
        // Contrôle musique
        function toggleMusic() {
            if (elements.bgMusic.paused) {
                elements.bgMusic.play();
                elements.musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
            } else {
                elements.bgMusic.pause();
                elements.musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
        }
        
        // Démarrer l'application
        init();
    </script>
</body>
</html>